#!/usr/bin/env ruby

require "bundler/setup"
require_relative "../spec/dummy/config/application.rb"
require_relative "../spec/dummy/config/initializers/get_smart.rb"
require "active_support/all"

Get::Smart.enabled = true
Get::Smart.logic.call

tree = {}
Get::Smart::Collection.new.root_topics.each do |topic|
  tree[topic] = Dir.glob(File.join(Dir.pwd, "files", topic, "**", "*.md")).size
end

tree.to_h.each do |topic, count|
  level = topic.count("/") - 1
  print "   " * level
  puts "#{topic.to_s.yellow} #{count.to_s.green}"
end
